<!DOCTYPE html>
<!--[if lt IE 8 ]><html class="no-js ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="no-js ie ie8" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js ie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html class="no-js" lang="en"> <!--<![endif]-->
<head>

   <!--- Basic Page Needs
   ================================================== -->
   <meta charset="utf-8">
	<title>Research</title>
	<meta name="description" content="">  
	<meta name="author" content="">
        
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});
    </script>
    <script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        th, td {
            text-align: center;
        }
    </style>
        
        <!-- Mobile Specific Metas
   ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
    ================================================== -->
   <link rel="stylesheet" href="css/base.css">
	<link rel="stylesheet" href="css/main.css">
   <link rel="stylesheet" href="css/media-queries.css">         

   <!-- Script
   =================================================== -->
	<script src="js/modernizr.js"></script>

   <!-- Favicons
	=================================================== -->
	<link rel="shortcut icon" href="favicon.png" >

</head>

<body>

   <div id="top"></div>
   <div id="preloader"> 
	   <div id="status">
         <img src="images/loader.gif" height="60" width="60" alt="">
         <div class="loader">Loading...</div>
      </div>
   </div>

   <!-- Header
   =================================================== -->
   <header id="main-header">

   	<div class="row header-inner">

	      <div class="logo">
              <a class="smoothscroll" </a>
	      </div>

	      <nav id="nav-wrap">         
	         
	         <a class="mobile-btn" href="#nav-wrap" title="Show navigation">
	         	<span class='menu-text'>Show Menu</span>
	         	<span class="menu-icon"></span>
	         </a>
         	<a class="mobile-btn" href="#" title="Hide navigation">
         		<span class='menu-text'>Hide Menu</span>
         		<span class="menu-icon"></span>
         	</a>         
            
	         <ul id="nav" class="nav">
                <li><a href="index.html#about">About</a></li>
                <li class="current"><a href="index.html#portfolio">Research</a></li>
	            <li><a href="index.html#journal">Blog</a></li>
	            <li><a href="index.html#contact">Contact</a></li>
	         </ul> 

	      </nav> <!-- /nav-wrap -->	      

	   </div> <!-- /header-inner -->

   </header>

   <!-- Content
   ================================================== -->
   <section id="content">

   	<div class="row portfolio-content">

	   	<div class="entry tab-whole nine columns centered">

	         <header class="entry-header">

					<h1 class="entry-title">
							Taxonomic Curriculum Learning
					</h1>
						 
				</header>

				<div class="entry-content">
                    
                    <h3> Motivation </h3>
                    
					<p>
                    Fine-grained object classes, by definition, share many visual features. With these shared visual features, we can group fine-grained classes into coarse clusters, which tend to form a visual taxonomy. The relevant visual features for distinguishing between classes in the taxonomy become more detailed with depth. Humans tend to learn object classes following this coarse to fine ordering. A child might start by first learning a base object class, such as a dog. As the child sees and interacts with dogs, he or she might learn to distinguish between big dogs and small dogs, then between classes of breeds, such as poodles, spaniels, and bulldogs. This stands in contrast to current methods of training deep networks, which involve training on all fine-grained classes simultaneously. We take inspiration from taxonomic training methods and <a href="http://ronan.collobert.com/pub/matos/2009_curriculum_icml.pdf">curriculum learning</a>, posing the following question: does ordering training into a series of coarse- to fine-grained tasks help in training a deep network? Here, we define ‘help’ to be either resulting in better fine-grained accuracy or more interpretable predictions, as defined by the taxonomy.
                    </p>
                    
                    <h3> Method </h3>
                    
                    <p>
                    We start by constructing visual taxonomies. The datasets, taxonomic construction method, and taxonomies are described <a href="non_expert_data.html"> here </a>. We work with the same experimental set-up, testing taxonomic curriculum learning on the dogs and birds domains. Given a visual taxonomy, we make distinct cuts progressively through the taxonomy, which we refer to as levels. Some classes may appear in multiple levels, while other classes may not appear in any. We then learn a classifier for each level. This supports batch processing and allows us to separate out the different classifiers to learn different features that are relevant for each level. With the levels of the taxonomy defining a set of similar, yet distinct learning tasks, we can employ some form of <a href="ftp://ftp.cs.wisc.edu/machine-learning/shavlik-group/torrey.handbook09.pdf">transfer learning</a> between them.
                    </p>
                    
                    <p>
                    In taxonomic curriculum learning, we start by training a model on the first level of the taxonomy, with each input example having a coarse-grained label. Once the network converges, we remove the classifier for the first level, replace it with a classifier for the second level, and, again, train until convergence. This process is repeated until we reach the end of the taxonomy. It should be noted that examples need not all have fine-grained labels: only examples for which we have corresponding labels are trained on at each level.
                    </p>
                    
                    <center>
                        <img src="images/training.png">
                            <p>
                            <em>Training methods.</em>
                            </p>
                    </center>
                    
                    <p>
                    We compare taxonomic curriculum learning with two baseline methods. The first is the standard approach of ignoring the taxonomy and training purely on labels at the fine-grained level. The second is multi-task learning, in which labels from all levels of the taxonomy are trained on simultaneously. We achieve this by adding multiple output layers to the network, one for each task, so that, given an input example, the network produces a prediction at each level of the taxonomy. If an example does not have a label at a particular level, then its gradient contribution for that level is zero. By comparing the performance of these two baselines with taxonomic curriculum learning, we can determine 1) whether or not the taxonomy assists in learning and 2) whether or not training on the levels of the taxonomy sequentially has any added benefit.
                    </p>
                    
                    <h3> Results </h3>
                    
                    <p>
                    <b> Accuracy-Based Comparison</b>
                    </p>
                    
                    We first compare taxonomic curriculum learning with the baseline methods on the basis of classification accuracy at each level of the taxonomy. For each trial, we re-initialized the loss layers in a pre-trained <a href="http://www.cs.unc.edu/~wliu/papers/GoogLeNet.pdf">GoogLeNet</a> network, then fine-tuned the entire network. With the standard approach to fine-grained learning, we trained only on the final level of the taxonomy and propagated predictions up to internal classes. With this approach, the accuracy $a_\ell$ at taxonomic level $\ell$ in a taxonomy of $L$ layers is given by
                    
                    \begin{equation}
                    a_\ell = \frac{1}{N} \sum_{i = 1}^N  1_{[\hat{y}_{i,L} \in \mathcal{L}(y_{i,\ell})]},
                    \end{equation}
                    
                    where $\mathcal{L}(y_{i,\ell})$ is the set of leaf classes in the sub-tree rooted at the internal class $y_{i,\ell}$, the ground truth label at level $\ell$ for example $i$, and $\hat{y}_{i,L}$ is the fine-grained prediction of the network for example $i$. With taxonomic curriculum learning and multi-task learning, accuracy at each level adheres to the normal definition, since we have predictions and labels at each level. Note that we do not enforce consistency in these predictions.
                    </p>
                    
                    <p>
                    We compared all three learning methods on both datasets for two cases. In the first case, all training examples have labels at the fine-grained level of the taxonomy, meaning there is an equal number of labels for each level: 52,701 for birds and 12,000 for dogs. In the second case, the labels for the training examples are skewed toward the coarse levels of the taxonomy. For both datasets, we selected subsets of images for each class (9 per class for birds and 5 per class for dogs) to have fine-grained labels, with all other examples having only coarse-grained labels. The following figure contains the test accuracy results of training with each method in each case.
                    </p>
                    
                    <center>
                        <img src="images/results_dogs_birds.png">
                            <p>
                            <em>Comparison of training methods by accuracy at each level of the taxonomy. Taxonomic curriculum learning outperforms the baseline methods when the class distribution is non-uniform.</em>
                            </p>
                    </center>
                    
                    <p>
                    
                    In the case of uniformly distributed labels at all levels of the taxonomy, taxonomic curriculum learning performs roughly as well as both baseline methods at all levels of the taxonomy. However, when the number of coarse-labeled examples is much greater than the number of examples with fine-grained labels, taxonomic curriculum learning surpasses the baselines. For fine-grained learning, the network simply has fewer training examples. With multi-task learning, there may be adverse competition between the levels of the taxonomy resulting from the difference in the number of data examples at each level.
                    </p>
                    
                    <p>
                    <b> Taxonomic Distance-Based Comparison</b>
                    </p>
                    
                    <p>
                    Another metric with which to evaluate the performance of taxonomic curriculum learning is through taxonomic distance. We define our taxonomic distance measure as follows:
                    
                    \begin{equation}
                    D_{\text{tax}} = L - \max_\ell (\ell \cdot 1_{\hat{y}_\ell = y_\ell}).
                    \end{equation}
                    
                    Thus, for a given example, the taxonomic distance is the number of levels above the leaf level at which the prediction first matches the label. A smaller taxonomic distance represents a more reasonable prediction, quantifying the fact that in a taxonomic setting, not all errors are equal.
                    
                    <table style="width:50%","float:center">
                        <tr>
                            <td></td>
                            <td>Ave. $D_\text{tax}$</td>
                        </tr>
                        <tr>
                            <td>Fine-Grained</td>
                            <td>1.608</td>
                        </tr>
                        <tr>
                            <td>Multi-task</td>
                            <td>1.289</td>		
                        </tr>
                        <tr>
                            <td>Taxonomic Curriculum</td>
                            <td><b>1.280</b></td>		
                        </tr>
                    </table>
                    
                    </p>
                    
				</div>
                
                <div id="disqus_thread"></div>
                <script>
                    /**
                     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                     */
                
                var disqus_config = function () {
                    this.page.url = 'http://joelouismarino.github.io/tax_curriculum_learning.html'; // Replace PAGE_URL with your page's canonical URL variable
                    this.page.identifier = tax_curriculum_learning; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                
                (function() { // DON'T EDIT BELOW THIS LINE
                 var d = document, s = d.createElement('script');
                 
                 s.src = '//marinoblog.disqus.com/embed.js';
                 
                 s.setAttribute('data-timestamp', +new Date());
                 (d.head || d.body).appendChild(s);
                 })();
                    </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	         
	      </div> <!-- /entry -->

	   </div> <!-- /portfolio-content -->
	   

   </section> <!-- /content -->  


<!-- Footer
 ================================================== -->
<footer>
    
    <div class="row">
        
        <div class="twelve columns tab-whole right-cols">
            
            <div class="row">
                
                <div class="columns">
                    <h3 class="address">Contact</h3>
                    <p>
                    jmarino [at] caltech.edu
                    </p>
                    <p>
                    1200 E. California Blvd.<br>
                    MC 136-93<br>
                    Pasadena, 91125 CA<br>
                    </p>
                    <p>
                    651.468.6441
                    </p>
                </div> <!-- /columns -->
                
                <div class="columns">
                    <h3 class="contact">Connect</h3>
                    
                    <ul>
                        <li><a href="https://www.linkedin.com/pub/joe-marino/37/bb0/73"><span></span><i class="fa fa-linkedin"></i></a>
                            <a href="https://github.com/joelouismarino"><span></span><i class="fa fa-github"></i></a>
                            <a href="https://www.facebook.com/joe.marino.9022"><span></span><i class="fa fa-facebook"></i></a>
                        </li>
                    </ul>
                    
                </div> <!-- /Row(nested) -->
                
            </div>
            
            <p class="copyright">&copy; Copyright 2016 Joseph Marino.</a></p>
            
            <div id="go-top">
                <a class="smoothscroll" title="Back to Top" href="#content"><span>Top</span><i class="fa fa-long-arrow-up"></i></a>
            </div>
            
        </div> <!-- /row -->
        
        </footer> <!-- /footer -->


   <!-- Java Script
   ================================================== -->
   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
   <script>window.jQuery || document.write('<script src="js/jquery-1.10.2.min.js"><\/script>')</script>
   <script type="text/javascript" src="js/jquery-migrate-1.2.1.min.js"></script>   
   <script src="js/jquery.flexslider.js"></script>
   <script src="js/jquery.fittext.js"></script>
   <script src="js/backstretch.js"></script> 
   <script src="js/waypoints.js"></script>  
   <script src="js/main.js"></script>

</body>

</html>